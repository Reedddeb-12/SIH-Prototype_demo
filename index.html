<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Heavy Metal Pollution Index (HMPI) Application</title>
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&family=Poppins:wght@400;600&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    
    <!-- Local Stylesheets -->
    <link rel="stylesheet" href="SRC/css/styles.css">
    <link rel="stylesheet" href="SRC/css/components.css">
    
    <style>
        /* Enhanced Hero Box Styling */
        .hero-content-box {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border-radius: 25px;
            padding: 60px 40px;
            margin: 0 auto;
            max-width: 900px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .hero-content-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #667eea, #764ba2, #4296ea, #43aef0);
        }
        
        .hero-content-box h1 {
            font-size: 4.5rem;
            font-weight: 900;
            margin-bottom: 20px;
            background: linear-gradient(45deg, #021670, #30039b);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: none;
            line-height: 1.1;
        }
        
        .hero-subtitle {
            font-size: 1.8rem;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 25px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .hero-description {
            font-size: 1.3rem;
            color: #495057;
            margin-bottom: 35px;
            line-height: 1.6;
            font-weight: 400;
        }
        
        .hero-cta {
            background: linear-gradient(45deg, #0e0f0f, #2d048b);
            color: white;
            padding: 18px 40px;
            border: none;
            border-radius: 30px;
            font-size: 1.2rem;
            font-weight: 700;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .hero-cta:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.6);
        }
        
        .hero-features {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 25px;
            margin-top: 40px;
        }
        
        .hero-feature {
            background: rgba(102, 126, 234, 0.1);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.2);
        }
        
        .hero-feature i {
            font-size: 2.5rem;
            color: #667eea;
            margin-bottom: 15px;
            display: block;
        }
        
        .hero-feature h4 {
            font-size: 1.1rem;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .hero-feature p {
            font-size: 0.9rem;
            color: #6c757d;
            margin: 0;
        }
        
        /* Mobile Responsive */
        @media (max-width: 768px) {
            .hero-content-box {
                margin: 20px;
                padding: 40px 30px;
                border-radius: 20px;
            }
            
            .hero-content-box h1 {
                font-size: 3rem;
            }
            
            .hero-subtitle {
                font-size: 1.4rem;
            }
            
            .hero-description {
                font-size: 1.1rem;
            }
            
            .hero-features {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
        
        @media (max-width: 480px) {
            .hero-content-box {
                margin: 10px;
                padding: 30px 20px;
            }
            
            .hero-content-box h1 {
                font-size: 2.5rem;
            }
            
            .hero-subtitle {
                font-size: 1.2rem;
                letter-spacing: 1px;
            }
            
            .hero-cta {
                padding: 16px 32px;
                font-size: 1.1rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">
                <i class="fas fa-flask"></i> THE ALCHEMISTS 
            </div>
            <ul class="nav-links">
                <li><a onclick="showTab('data-entry')">Data Entry</a></li>
                <li><a onclick="showTab('mapping')">Map View</a></li>
                <li><a onclick="showTab('leaderboard')">Leaderboard</a></li>
                <li><a onclick="showTab('analytics')">Analytics</a></li>
            </ul>
        </nav>
    </header>

    <section class="hero">
        <div class="container">
            <div class="hero-content-box">
                <h1>PURE-Intelligence</h1>
                <div class="hero-subtitle">"Pollution & Utility Risk Evaluation"</div>
                <p class="hero-description">AI-powered monitoring system for heavy metal water pollutants with advanced health risk prediction and real-time pollution analysis.</p>
                
                <button class="hero-cta" onclick="showTab('data-entry')">
                    <i class="fas fa-play"></i> Start Monitoring
                </button>
                
                <div class="hero-features">
                    <div class="hero-feature">
                        <i class="fas fa-brain"></i>
                        <h4>AI-Powered</h4>
                        <p>Machine learning disease prediction</p>
                    </div>
                    <div class="hero-feature">
                        <i class="fas fa-map-marked-alt"></i>
                        <h4>Interactive Maps</h4>
                        <p>Heatmap visualization & location tracking</p>
                    </div>
                    <div class="hero-feature">
                        <i class="fas fa-chart-line"></i>
                        <h4>Real-time Analytics</h4>
                        <p>Comprehensive pollution analysis</p>
                    </div>
                    <div class="hero-feature">
                        <i class="fas fa-shield-alt"></i>
                        <h4>Health Protection</h4>
                        <p>Risk assessment & recommendations</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <main class="container">
        <div class="main-content">
            <div class="tabs">
                <button class="tab active" onclick="showTab('data-entry')">
                    <i class="fas fa-database"></i> Data Entry
                </button>
                <button class="tab" onclick="showTab('disease-prediction')">
                    <i class="fas fa-heartbeat"></i> Disease Prediction
                </button>
                <button class="tab" onclick="showTab('mapping')">
                    <i class="fas fa-map"></i> Interactive Map
                </button>
                <button class="tab" onclick="showTab('leaderboard')">
                    <i class="fas fa-trophy"></i> Leaderboard
                </button>
                <button class="tab" onclick="showTab('analytics')">
                    <i class="fas fa-chart-bar"></i> Analytics
                </button>
            </div>

            <!-- Data Entry Tab -->
            <div id="data-entry" class="tab-content active">
                <h2>Water Quality Data Entry</h2>
                
                <div class="form-section">
                    <h3><i class="fas fa-map-marker-alt"></i> Location Information</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="location-name">Location Name</label>
                            <input type="text" id="location-name" placeholder="Enter location name">
                        </div>
                        <div class="form-group">
                            <label for="latitude">Latitude</label>
                            <input type="number" id="latitude" step="any" placeholder="e.g., 18.5204">
                        </div>
                        <div class="form-group">
                            <label for="longitude">Longitude</label>
                            <input type="number" id="longitude" step="any" placeholder="e.g., 73.8567">
                        </div>
                        <div class="form-group">
                            <label for="sample-date">Sample Date</label>
                            <input type="date" id="sample-date">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-flask"></i> Heavy Metal Concentrations (mg/L)</h3>
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="lead">Lead (Pb)</label>
                            <input type="number" id="lead" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="mercury">Mercury (Hg)</label>
                            <input type="number" id="mercury" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="cadmium">Cadmium (Cd)</label>
                            <input type="number" id="cadmium" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="arsenic">Arsenic (As)</label>
                            <input type="number" id="arsenic" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="chromium">Chromium (Cr)</label>
                            <input type="number" id="chromium" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="copper">Copper (Cu)</label>
                            <input type="number" id="copper" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="zinc">Zinc (Zn)</label>
                            <input type="number" id="zinc" step="0.001" placeholder="0.000" min="0">
                        </div>
                        <div class="form-group">
                            <label for="nickel">Nickel (Ni)</label>
                            <input type="number" id="nickel" step="0.001" placeholder="0.000" min="0">
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-upload"></i> Bulk Data Upload</h3>
                    <div class="upload-area" id="upload-area">
                        <i class="fas fa-cloud-upload-alt upload-icon"></i>
                        <h4>Drag & drop CSV files here or click to browse</h4>
                        <p>Supported formats: CSV</p>
                        <div class="supported-formats">
                            <span class="format-badge">CSV</span>
                        </div>
                        <input type="file" id="file-upload" accept=".csv" style="display: none;">
                        <button class="calculate-btn" onclick="document.getElementById('file-upload').click()">
                            <i class="fas fa-folder-open"></i> Choose File
                        </button>
                        <div class="upload-tools">
                            <button class="calculate-btn template-btn" onclick="downloadTemplate()">
                                <i class="fas fa-download"></i> Download Template
                            </button>
                            <button class="calculate-btn demo-btn" onclick="loadDemoData()">
                                <i class="fas fa-play"></i> Load Demo Data
                            </button>
                        </div>
                    </div>
                </div>

                <div style="text-align: center;">
                    <button class="calculate-btn" onclick="calculateIndices()">
                        <i class="fas fa-calculator"></i> Calculate Pollution Indices
                    </button>
                    <button class="calculate-btn" onclick="predictHealthRisk()">
                        <i class="fas fa-heartbeat"></i> Predict Health Risk
                    </button>
                    <button class="calculate-btn" onclick="clearForm()" style="background: linear-gradient(45deg, #e74c3c, #c0392b);">
                        <i class="fas fa-trash"></i> Clear Form
                    </button>
                </div>

                <div id="results" style="display: none;">
                    <div class="results-section">
                        <h3><i class="fas fa-chart-line"></i> Pollution Analysis Results</h3>
                        <div class="results-grid">
                            <div class="result-card">
                                <h4><i class="fas fa-thermometer-half"></i> Heavy Metal Pollution Index (HPI)</h4>
                                <div class="result-value" id="hpi-value">-</div>
                                <div class="result-status" id="hpi-status">-</div>
                                <p style="margin-top: 10px; opacity: 0.9;">Overall pollution assessment based on weighted metal concentrations</p>
                            </div>
                            <div class="result-card">
                                <h4><i class="fas fa-weight"></i> Heavy Metal Evaluation Index (HEI)</h4>
                                <div class="result-value" id="hei-value">-</div>
                                <div class="result-status" id="hei-status">-</div>
                                <p style="margin-top: 10px; opacity: 0.9;">Sum of concentration ratios to permissible limits</p>
                            </div>
                            <div class="result-card">
                                <h4><i class="fas fa-exclamation-triangle"></i> Contamination Degree (Cd)</h4>
                                <div class="result-value" id="cd-value">-</div>
                                <div class="result-status" id="cd-status">-</div>
                                <p style="margin-top: 10px; opacity: 0.9;">Cumulative contamination factor assessment</p>
                            </div>
                            <div class="result-card">
                                <h4><i class="fas fa-heartbeat"></i> Health Risk Prediction</h4>
                                <div class="result-value" id="health-risk-value">-</div>
                                <div class="result-status" id="health-risk-status">-</div>
                                <p style="margin-top: 10px; opacity: 0.9;">AI-powered health risk assessment</p>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <h4><i class="fas fa-lightbulb"></i> Key Contributing Factors</h4>
                            <div id="risk-factors" style="margin-top: 15px;">
                                <!-- Risk factors will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Disease Prediction Tab -->
            <div id="disease-prediction" class="tab-content">
                <h2>AI-Powered Disease Risk Prediction</h2>
                <p>Advanced machine learning analysis of health risks based on heavy metal exposure levels.</p>
                
                <div class="form-section">
                    <h3><i class="fas fa-brain"></i> ML Model Status</h3>
                    <div id="ml-status" class="alert alert-info">
                        <i class="fas fa-spinner fa-spin"></i> Loading disease prediction model...
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-calculator"></i> Prediction Controls</h3>
                    <div style="text-align: center;">
                        <button class="calculate-btn" onclick="runDiseaseAnalysis()" id="predict-btn" disabled>
                            <i class="fas fa-microscope"></i> Run Disease Risk Analysis
                        </button>
                        <button class="calculate-btn" onclick="generateHealthReport()" style="background: linear-gradient(45deg, #27ae60, #2ecc71);">
                            <i class="fas fa-file-medical"></i> Generate Health Report
                        </button>
                    </div>
                </div>

                <div id="disease-results" style="display: none;">
                    <div class="results-section">
                        <h3><i class="fas fa-chart-pie"></i> Disease Risk Analysis</h3>
                        
                        <div class="result-card" style="margin-bottom: 25px;">
                            <h4><i class="fas fa-thermometer-three-quarters"></i> Overall Health Risk</h4>
                            <div class="result-value" id="overall-risk-value">-</div>
                            <div class="result-status" id="overall-risk-status">-</div>
                        </div>

                        <div class="results-grid" id="disease-predictions-grid">
                            <!-- Disease predictions will be populated here -->
                        </div>
                        
                        <div style="margin-top: 30px;" id="health-recommendations">
                            <h4><i class="fas fa-stethoscope"></i> Health Recommendations</h4>
                            <div id="recommendations-content">
                                <!-- Recommendations will be populated here -->
                            </div>
                        </div>

                        <div style="margin-top: 30px;" id="critical-metals-section">
                            <h4><i class="fas fa-exclamation-triangle"></i> Critical Metal Exposure</h4>
                            <div id="critical-metals-content">
                                <!-- Critical metals will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>

                <div class="form-section">
                    <h3><i class="fas fa-info-circle"></i> About Disease Prediction</h3>
                    <div style="background: white; padding: 20px; border-radius: 10px;">
                        <p><strong>Our AI Model analyzes:</strong></p>
                        <ul style="margin-left: 20px; margin-top: 10px;">
                            <li>Heavy metal concentration patterns</li>
                            <li>Synergistic effects of multiple metals</li>
                            <li>Dose-response relationships from medical literature</li>
                            <li>Population-based risk factors</li>
                        </ul>
                        <p style="margin-top: 15px;"><strong>Predicted Diseases Include:</strong></p>
                        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-top: 10px;">
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Neurological Disorders</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Kidney Disease</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Cardiovascular Disease</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Respiratory Issues</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">GI Problems</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Skin Disorders</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Cancer Risk</span>
                            <span style="background: #ecf0f1; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem;">Bone Disease</span>
                        </div>
                        <div class="alert alert-info" style="margin-top: 15px;">
                            <strong>Disclaimer:</strong> This tool provides risk assessment based on exposure data and should not replace professional medical consultation. Always consult healthcare providers for accurate diagnosis and treatment.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mapping Tab -->
            <div id="mapping" class="tab-content">
                <h2>Interactive Pollution Map & Heatmap</h2>
                <p>Visualize pollution data across different locations with interactive markers, detailed information, and heatmap overlays.</p>
                <div id="map"></div>
                
                <div style="margin-top: 30px;">
                    <h3>Recent Monitoring Locations</h3>
                    <table class="data-table" id="locations-table">
                        <thead>
                            <tr>
                                <th>Location</th>
                                <th>Date</th>
                                <th>HPI</th>
                                <th>HEI</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="6" style="text-align: center; padding: 40px; color: #6c757d;">
                                    <i class="fas fa-database" style="font-size: 2rem; margin-bottom: 10px; display: block;"></i>
                                    No monitoring data available. Start by adding location data!
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Leaderboard Tab -->
            <div id="leaderboard" class="tab-content">
                <h2>Water Quality Leaderboard</h2>
                <p>Track pollution levels across different monitoring locations.</p>
                
                <div class="leaderboard-container">
                    <div class="leaderboard-card">
                        <h3><i class="fas fa-exclamation-circle"></i> Most Polluted Areas</h3>
                        <div id="pollution-leaderboard">
                            <div class="alert alert-info" style="text-align: center;">
                                <i class="fas fa-database"></i>
                                No pollution data available. Start by adding monitoring data!
                            </div>
                        </div>
                    </div>
                    
                    <div class="leaderboard-card">
                        <h3><i class="fas fa-leaf"></i> Cleanest Areas</h3>
                        <div id="clean-leaderboard">
                            <div class="alert alert-info" style="text-align: center;">
                                <i class="fas fa-database"></i>
                                No data available. Add monitoring locations to see rankings!
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Analytics Tab -->
            <div id="analytics" class="tab-content">
                <h2>Advanced Analytics & Insights</h2>
                <p>Comprehensive analysis and trends in water quality monitoring with exportable reports.</p>
                
                <div class="form-section">
                    <h3><i class="fas fa-chart-area"></i> Pollution Trends</h3>
                    <canvas id="trendsChart" width="400" height="200"></canvas>
                </div>
                
                <div class="form-section">
                    <h3><i class="fas fa-bullseye"></i> Metal Distribution</h3>
                    <canvas id="distributionChart" width="400" height="200"></canvas>
                </div>
                
                <div class="form-section">
                    <h3><i class="fas fa-download"></i> Export & Reports</h3>
                    <div style="text-align: center;">
                        <button class="calculate-btn" onclick="exportResults()">
                            <i class="fas fa-download"></i> Export Data (CSV)
                        </button>
                        <button class="calculate-btn" onclick="exportHeatmapData()" style="background: linear-gradient(45deg, #e67e22, #d35400);">
                            <i class="fas fa-fire"></i> Export Heatmap Data
                        </button>
                        <button class="calculate-btn" onclick="generateReport()" style="background: linear-gradient(45deg, #f39c12, #e67e22);">
                            <i class="fas fa-file-pdf"></i> Generate Report
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- AI Chatbot -->
    <div class="chatbot-container">
        <button class="chatbot-toggle" onclick="toggleChatbot()">
            <i class="fas fa-comments"></i>
        </button>
        <div class="chatbot-window" id="chatbot-window">
            <div class="chatbot-header">
                <div>
                    <i class="fas fa-robot"></i> HMPI Assistant
                </div>
                <button onclick="toggleChatbot()" style="background: none; border: none; color: white; font-size: 1.2rem; cursor: pointer;">×</button>
            </div>
            <div class="chatbot-messages" id="chatbot-messages">
                <div class="message bot">
                    <strong>HMPI Assistant:</strong> Hello! I'm here to help you understand heavy metal pollution and use this application. Ask me about pollution indices, health risks, heatmaps, or how to use any features!
                </div>
            </div>
            <div class="chatbot-input">
                <input type="text" id="chatbot-input" placeholder="Ask me about pollution monitoring..." onkeypress="handleChatKeyPress(event)">
                <button onclick="sendChatMessage()">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- External Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.heat/0.2.0/leaflet-heat.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@latest/dist/tf.min.js"></script>
    
    <!-- Local Scripts -->
    <script src="SRC/js/utils.js"></script>
    <script src="SRC/js/calculations.js"></script>
    <script src="SRC/js/ml-model.js"></script>
    <script src="SRC/js/map.js"></script>
    <script src="SRC/js/charts.js"></script>
    <script src="SRC/js/chatbot.js"></script>
    <script src="SRC/js/main.js"></script>
    
    <script>
        // Global variables
        let waterQualityData = [];
        let map = null;
        let markers = [];
        let chartInstances = { trends: null, distribution: null };

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            document.getElementById('sample-date').value = new Date().toISOString().split('T')[0];
            
            // Initialize map when mapping tab is shown
            setTimeout(() => {
                if (typeof initializeMap === 'function') {
                    initializeMap();
                }
            }, 100);
            
            // Initialize charts
            if (typeof initializeCharts === 'function') {
                initializeCharts();
            }
            
            // Load saved data from local storage if available
            if (typeof loadDataFromLocal === 'function') {
                loadDataFromLocal();
            }
            
            console.log('PURE-Intelligence System Initialized');
        });

        // Tab functionality
        function showTab(tabName) {
            // Remove active class from all tabs and tab contents
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.style.display = 'none');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Show corresponding tab content
            const tabContent = document.getElementById(tabName);
            if (tabContent) {
                tabContent.style.display = 'block';
                tabContent.classList.add('active');
            }
            
            // Special handling for map tab
            if (tabName === 'mapping' && map) {
                setTimeout(() => map.invalidateSize(), 100);
            }
            
            // Update charts if analytics tab
            if (tabName === 'analytics' && typeof updateCharts === 'function') {
                updateCharts();
            }
        }
    </script>
</body>
</html>

